function get_mediainfo(mediainfoIndex) {
    switch (mediainfoIndex) {

        		case 0:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/01-JasonZander-Keynote.wmv", "placeholderImage": "Images/01-JasonZander-Keynote.JPG", "chapters": [] };
		case 1:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/02-MadsTorgersen-CSharp4Dynamic.wmv", "placeholderImage": "Images/02-MadsTorgersen-CSharp4Dynamic.JPG", "chapters": [] };
		case 2:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/03-TedNeward-ObjectiveCSharp.wmv", "placeholderImage": "Images/03-TedNeward-ObjectiveCSharp.JPG", "chapters": [] };
		case 3:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/04-JeffreySax-NumericalComputingDLR.wmv", "placeholderImage": "Images/04-JeffreySax-NumericalComputingDLR.JPG", "chapters": [] };
		case 4:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/05-MatthewWilson-Perl.wmv", "placeholderImage": "Images/05-MatthewWilson-Perl.JPG", "chapters": [] };
		case 5:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/06-TedNeward-VSLangService.wmv", "placeholderImage": "Images/06-TedNeward-VSLangService.JPG", "chapters": [] };
		case 6:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/07-EmmanuelStapf-Eiffel.wmv", "placeholderImage": "Images/07-EmmanuelStapf-Eiffel.JPG", "chapters": [] };
		case 7:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/08-GiladBracha-Hopscotch.wmv", "placeholderImage": "Images/08-GiladBracha-Hopscotch.JPG", "chapters": [] };
		case 8:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/09-KeithRobertson-Sable.wmv", "placeholderImage": "Images/09-KeithRobertson-Sable.JPG", "chapters": [] };
		case 9:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/10-TimMacFarlaine-LightningTycho.wmv", "placeholderImage": "Images/10-TimMacFarlaine-LightningTycho.JPG", "chapters": [] };
		case 10:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/11-AndersHejlsberg-LightningCovariantContravariant.wmv", "placeholderImage": "Images/11-AndersHejlsberg-LightningCovariantContravariant.JPG", "chapters": [] };
		case 11:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/12-RomanIvantsov-Irony.wmv", "placeholderImage": "Images/12-RomanIvantsov-Irony.JPG", "chapters": [] };
		case 12:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/13-RomanIvantsov-IronPythonMSDynamic.wmv", "placeholderImage": "Images/13-RomanIvantsov-IronPythonMSDynamic.JPG", "chapters": [] };
		case 13:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/14-JeffreySnover-Powershell.wmv", "placeholderImage": "Images/14-JeffreySnover-Powershell.JPG", "chapters": [] };
		case 14:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/15-KarlProsser-PowershellDSL.wmv", "placeholderImage": "Images/15-KarlProsser-PowershellDSL.JPG", "chapters": [] };
		case 15:
		   return { "mediaUrl": "http://download.microsoft.com/download/B/F/0/BF0DAE51-F096-4DB4-8707-ACBDB7680BC0/17-JimPurbrick-SecondLife.wmv", "placeholderImage": "Images/17-JimPurbrick-SecondLife.JPG", "chapters": [] };
		case 16:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/18-LarsBak-JavaScript.wmv", "placeholderImage": "Images/18-LarsBak-JavaScript.JPG", "chapters": [] };
		case 17:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/19-JohnRose-JVM.wmv", "placeholderImage": "Images/19-JohnRose-JVM.JPG", "chapters": [] };
		case 18:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/20-JoshuaGoodman-CLR.wmv", "placeholderImage": "Images/20-JoshuaGoodman-CLR.JPG", "chapters": [] };
		case 19:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/21-AmanderLauter-FSharpConcurrency.wmv", "placeholderImage": "Images/21-AmanderLauter-FSharpConcurrency.JPG", "chapters": [] };
		case 20:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/22-TomasPatricek-Reactive.wmv", "placeholderImage": "Images/22-TomasPatricek-Reactive.JPG", "chapters": [] };
		case 21:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/23-ErikMeijer-LiveLabsReactiveFramework.wmv", "placeholderImage": "Images/23-ErikMeijer-LiveLabsReactiveFramework.JPG", "chapters": [] };
		case 22:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/24-JasonOlson-FSharp.wmv", "placeholderImage": "Images/24-JasonOlson-FSharp.JPG", "chapters": [] };
		case 23:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/25-LukeHoban-FSharpProductization.wmv", "placeholderImage": "Images/25-LukeHoban-FSharpProductization.JPG", "chapters": [] };
		case 24:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/26-HermanVenter-CCI.wmv", "placeholderImage": "Images/26-HermanVenter-CCI.JPG", "chapters": [] };
		case 25:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/27-HarryPierson-IPyDbg.wmv", "placeholderImage": "Images/27-HarryPierson-IPyDbg.JPG", "chapters": [] };
		case 26:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/28-FrankWierzbicki-Jython.wmv", "placeholderImage": "Images/28-FrankWierzbicki-Jython.JPG", "chapters": [] };
		case 27:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/29-PhilipWadler-Links.wmv", "placeholderImage": "Images/29-PhilipWadler-Links.JPG", "chapters": [] };
		case 28:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/30-WesnerMoise-StaticAnalysis.wmv", "placeholderImage": "Images/30-WesnerMoise-StaticAnalysis.JPG", "chapters": [] };
		case 29:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/31-JasonOlson-ModernOO.wmv", "placeholderImage": "Images/31-JasonOlson-ModernOO.JPG", "chapters": [] };
		case 30:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/32-JoshuaPhillips-Axum.wmv", "placeholderImage": "Images/32-JoshuaPhillips-Axum.JPG", "chapters": [] };
		case 31:
		   return { "mediaUrl": "http://download.microsoft.com/download/7/6/A/76A69AE5-72B5-4005-BBD9-7EA5F4795014/33-KeithCurtis-SurveyOfToolsAndLanguages.wmv", "placeholderImage": "Images/33-KeithCurtis-SurveyOfToolsAndLanguages.JPG", "chapters": [] };
		case 32:
		   return { "mediaUrl": "http://download.microsoft.com/download/fake/34-ManuelFahndrich-CodeContracts.wmv", "placeholderImage": "Images/34-ManuelFahndrich-CodeContracts.JPG", "chapters": [] };
		case 33:
		   return { "mediaUrl": "http://download.microsoft.com/download/fake/35-JoeMistachkin-Eagle.wmv", "placeholderImage": "Images/35-JoeMistachkin-Eagle.JPG", "chapters": [] };
		case 34:
		   return { "mediaUrl": "http://download.microsoft.com/download/fake/36-PeliDeHalleux-Pex.wmv", "placeholderImage": "Images/36-PeliDeHalleux-Pex.JPG", "chapters": [] };
		case 35:
		   return { "mediaUrl": "http://download.microsoft.com/download/fake/37-PaulVickDavidLangworthy-M.wmv", "placeholderImage": "Images/37-PaulVickDavidLangworthy-M.JPG", "chapters": [] };


        default:
             throw Error.invalidOperation("No such mediainfo");
     }
}

function StartWithParent(mediainfoId, parentId, appId) {
    new StartPlayer(mediainfoId, parentId);
}

function StartPlayer(mediainfoId, parentId) {
    this._hostname = EePlayer.Player._getUniqueName("xamlHost");
    // NOTE: player uses "xml" extension since server doesn't support xaml mime-type
    Silverlight.createObjectEx( { source: 'Player/player.xml', 
                                  parentElement: $get(parentId ||"divPlayer_0"), 
                                  id: this._hostname, 
                                  properties: { 
                                    width:'100%', 
                                    height:'100%', 
                                    version:'1.0', 
					                          background:document.body.style.backgroundColor, isWindowless:'false' 
                                  },
                                  events: { 
                                    onLoad:Function.createDelegate(this, this._handleLoad) 
                                  } 
                                } 
                              );
    this._currentMediainfo = mediainfoId;
}
StartPlayer.prototype= {
    _handleLoad: function() {
        this._player = $create(   ExtendedPlayer.Player, 
                                  { // properties
                                    autoPlay    : true, 
                                    volume      : 1.0,
                                    muted       : false
                                  }, 
                                  { // event handlers
                                    mediaEnded: Function.createDelegate(this, this._onMediaEnded),
                                    mediaFailed: Function.createDelegate(this, this._onMediaFailed)
                                  },
                                  null, $get(this._hostname)  ); 
        this._playNextVideo();     
    },    
    _onMediaEnded: function(sender, eventArgs) {
        window.setTimeout( Function.createDelegate(this, this._playNextVideo), 1000);
    },
    _onMediaFailed: function(sender, eventArgs) {
        alert(String.format( Ee.UI.Xaml.Media.Res.mediaFailed, this._player.get_mediaUrl() ) );
    },
    _playNextVideo: function() {
        // TODO: update this with the total videos!
        var cVideos = 36;
        if (this._currentMediainfo<cVideos)
            this._player.set_mediainfo( get_mediainfo( this._currentMediainfo++ ) );    
    }        
}
